let buttonCreate=document.getElementById("createVisit"),visitInput=document.getElementById("doctor-selector"),dateInput=document.getElementById("visitDate"),lastDate=document.getElementById("lastDate"),fullNameInput=document.getElementById("fullName"),input=document.getElementById("formElem"),div=document.getElementById("result"),title=document.getElementById("title"),pressure=document.getElementById("pulse"),bodyMassIndex=document.getElementById("pulse"),pastDiseases=document.getElementById("cardio-deceases"),age=document.getElementById("age"),text="";const data={email:"marvelichkovkiy@gmail.com",password:"1234567890"};class Visit{constructor(e,t,a){this.visitName=e.selectedOptions[0].value,this.fullName=a.value,this.visitDate=t.value,this.token=this.getData(),this.sendData=this.postData(),this.card=this.createCard()}getData(e="",t={}){return fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(t)}).then(e=>e.json())}postData(e="",t={}){return fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{Authorization:"Bearer "+localStorage.getItem("token")},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(t)}).then(e=>e.json())}deleteData(e="",t={}){return fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer",body:""+localStorage.getItem("token")}).then(e=>e)}createCard(){let e={"Доктор":document.querySelector("[name=doctor]").value,"Цель":document.querySelector("[name=title]").value,"Описание":document.querySelector("[name=description]").value,"Статус":"open","Приоритет":"Приоритет"};return Object.entries(e)}render(){this.getData("http://cards.danit.com.ua/login",data).then(e=>localStorage.setItem("token",e.token)).catch(e=>console.error(e)),this.postData("http://cards.danit.com.ua/cards",this.createCard()).then(e=>localStorage.setItem("id",e.id)).catch(e=>console.error(e));let e=this.createCard();console.log(e);let t=document.getElementById("deleteCard"),a=document.getElementById("result");a.innerHTML="";for(let n=0;n<e.length;n++){let r=document.createElement("li");r.innerHTML=e[n],a.append(r),a.append(t)}$(".note:first").clone().appendTo(".content").show().draggable({containment:".content"}),$("#empty").hide()}}class VisitCardio extends Visit{constructor(e,t,a,n,r,s,o,l){super(e,t,a),this.titile=n.value,this.pressure=r.value,this.bodyMassIndex=s.value,this.pastDiseases=o.value,this.age=l.value}getData(e="",t={}){return super.getData(e,t)}postData(e="",t={}){return super.postData(e,t)}deleteData(e="",t={}){return super.deleteData(e,t)}render(){super.render()}}class VisitDentist extends Visit{constructor(e,t,a,n,r){super(e,t,a),this.titile=n.value,this.lastDate=r.value,this.visitName=e.selectedOptions[0].value,this.visitDate=t.value}getData(e="",t={}){return super.getData(e,t)}postData(e="",t={}){return super.postData(e,t)}deleteData(e="",t={}){return super.deleteData(e,t)}render(){super.render()}}class VisitTherapist extends Visit{constructor(e,t,a,n,r){super(e,t,a),this.title=n.value,this.age=r.value}getData(e="",t={}){return super.getData(e,t)}postData(e="",t={}){return super.postData(e,t)}deleteData(e="",t={}){return super.deleteData(e,t)}render(){super.render()}}buttonCreate.addEventListener("click",(function(){if("cardiologist"===doctor.selectedOptions[0].value){let e=new VisitCardio(visitInput,dateInput,fullNameInput,title,pressure,bodyMassIndex,pastDiseases,age);buttonCreate.addEventListener("click",e.render),e.render(),console.log(e)}else if("dentist"===doctor.selectedOptions[0].value){let e=new VisitDentist(visitInput,dateInput,fullNameInput,title,lastDate);buttonCreate.addEventListener("click",e.render),e.render(),console.log(e)}else if("therapist"===doctor.selectedOptions[0].value){let e=new VisitTherapist(visitInput,dateInput,fullNameInput,title,age);buttonCreate.addEventListener("click",e.render),e.render(),console.log(e)}})),$(".content").on("click",".delete_card",(function(){$(this).parent().remove()}));let buttonDelete=document.getElementById("deleteCard");buttonDelete.addEventListener("click",(function(){if("cardiologist"===doctor.selectedOptions[0].value){let e=new VisitCardio(visitInput,dateInput,fullNameInput,title,pressure,bodyMassIndex,pastDiseases,age);buttonDelete.addEventListener("click",e.deleteData),e.deleteData("http://cards.danit.com.ua/cards/"+localStorage.getItem("id"),data).then(e=>e.json()).catch(e=>console.error(e)),e.deleteData(),console.log(e)}else if("dentist"===doctor.selectedOptions[0].value){let e=new VisitDentist(visitInput,dateInput,fullNameInput,title,lastDate);buttonDelete.addEventListener("click",e.deleteData),e.deleteData("http://cards.danit.com.ua/cards/"+localStorage.getItem("id"),data).then(e=>e.json()).catch(e=>console.error(e)),e.deleteData(),console.log(e)}else if("therapist"===doctor.selectedOptions[0].value){let e=new VisitTherapist(visitInput,dateInput,fullNameInput,title,age);buttonDelete.addEventListener("click",e.deleteData),e.deleteData("http://cards.danit.com.ua/cards/"+localStorage.getItem("id"),data).then(e=>e.json()).catch(e=>console.error(e)),e.deleteData(),console.log(e)}}));