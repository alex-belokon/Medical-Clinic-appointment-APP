import VisitCardiologist from"../classes/VisitCardiologist.js";import VisitDentist from"../classes/VisitDentist.js";import VisitTherapist from"../classes/VisitTherapist.js";import pushInfoToDB from"./pushInfoToDB.js";import putInfoToDB from"./putInfoToDB.js";import getInfoFromDB from"./getInfoFromDB.js";import createNewCard from"./createNewCard.js";import CreateCard from"../classes/CreateCard.js";import cardsBtnsHandler from"./cardsBtnsHandler.js";import clearModalFields from"./clearModalFields.js";export default function createDoctorForm(e,t,a="",s={},o=!0){const r=new VisitCardiologist({classes:["modal","visit"]}).render(),i=new VisitDentist({classes:["modal","visit"]}).render(),l=new VisitTherapist({classes:["modal","visit"]}).render(),d=document.querySelector("#doctorForm");let n,c,u,m,v,p;o&&(null!=d&&d.remove(),s={status:"Open"}),1===e&&(s.doctor="Cardiologist",t.append(r),n=document.querySelector("#pressure"),c=document.querySelector("#massindex"),u=document.querySelector("#diseases"),m=document.querySelector("#cardioage")),2===e&&(s.doctor="Dentist",t.append(i),p=document.querySelector("#lastvisitdate")),3===e&&(s.doctor="Therapist",t.append(l),v=document.querySelector("#therapistage"));const y=document.querySelector("#purpose"),f=document.querySelector("#description"),g=document.querySelector("#patient"),I=Array.from(document.querySelector(".urgency").children),h=document.querySelector("#generaladdinfo");o||([y.value,f.value,g.value,h.value]=[s.title,s.description,s.fullName,s.addInfo],I.forEach(e=>{e.value==s.priority&&e.setAttribute("selected","selected")}),1===e&&([n.value,c.value,u.value,m.value]=[s.pressure,s.massIndex,s.diseases,s.age]),2===e&&(p.value=s.lastvisitdate),3===e&&(v.value=s.age_));document.getElementById("submitvisit").addEventListener("click",(function(r){r.preventDefault();const i=document.querySelector(".urgency");let l=!0;s.title=y.value,s.description=f.value,s.fullName=g.value,s.priority=i.value,s.addInfo=h.value,y.validity.valid&&f.validity.valid&&g.validity.valid&&i.validity.valid||(l=!1),1===e&&(s.pressure=n.value,s.massIndex=c.value,s.diseases=u.value,s.age=m.value,n.validity.valid&&c.validity.valid&&u.validity.valid&&m.validity.valid||(l=!1)),2===e&&(s.lastvisitdate=p.value,p.validity.valid||(l=!1)),3===e&&(s.age_=v.value,v.validity.valid||(l=!1)),l?(o?(getInfoFromDB().then(e=>{0==e.length&&document.getElementById("noitems").remove()}),pushInfoToDB(s).then(e=>{const t=JSON.parse(e).id;createNewCard(t,s)}).catch(e=>{console.log(e.message)})):putInfoToDB(a,s).then(e=>{const t=document.getElementById(a),o=JSON.parse(e).content,r=new CreateCard({id:a,content:o}).render();if(document.getElementById("divCardsId").replaceChild(r,t),"Done"==s.status){r.getElementsByClassName("cards-btn done")[0].disabled=!0}cardsBtnsHandler(r,o)}).catch(e=>{console.log(e.message)}),t.classList.remove("active"),clearModalFields(t)):console.log("Some field(s) do(es) not valid")}))}